<ng-container *ngIf="(clients$ | async) as result" [ngSwitch]="result.dataState">
  <ng-container *ngSwitchCase="DataStateEnum.LOADING">
    <nz-spin nzTip="Loading...">
    </nz-spin>
  </ng-container>
  <ng-container *ngSwitchCase="DataStateEnum.Error">
    <div class="alert alert-danger alert-with-icon">
      <i class="material-icons" data-notify="icon">error_outline</i>
      <button aria-label="Close" class="close" data-dismiss="alert" mat-button type="button"><i class="material-icons">close</i>
      </button>
      <span data-notify="message">
        <b>Error</b>{{result.errorMessage}}</span>
    </div>
  </ng-container>
  <ng-container *ngSwitchCase="DataStateEnum.LOADED">
    <nz-table #nestedTable [nzData]="result.data" [nzPageSize]="10">
      <thead >
      <tr>
        <th class="bg-info" style="color: white"></th>
        <th class="bg-info" style="color: white">Nom Complet</th>
        <th class="bg-info" style="color: white">Email</th>
        <th class="bg-info" style="color: white">Telephone</th>
        <th class="bg-info" style="color: white">Address</th>
        <th class="bg-info" style="color: white">Status</th>
        <th class="bg-info" style="color: white">Action</th>
      </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let data of nestedTable.data">
        <tr>
          <td (nzExpandChange)="onExpandChange(data.id, $event)" [nzExpand]="expandSet.has(data.id)"></td>
          <td>{{ data.firstName }} {{ data.lastName }}</td>
          <td>{{ data.email }}</td>
          <td>{{ data.phone}}</td>
          <td>{{ data.address}}</td>
          <td>{{ data.isActive }}</td>
          <td>
            <div nz-row nzJustify="space-between" >
            <ng-template [ngIf]="data.isActive==true">
              <a><i class="material-icons" style="color: green" (click)="disableClient(data)">toggle_on</i></a>
            </ng-template>
            <ng-template [ngIf]="data.isActive==false">
              <a><i class="material-icons" style="color: red" (click)="disableClient(data)">toggle_off</i></a>
            </ng-template>
            <a><i class="material-icons" style="color: orange" (click)="deleteClient(data)">delete</i></a>
            <a><i class="material-icons" style="color: #2CA8FF" (click)="createTplModal(tplContent, tplFooter,data)">mode_edit</i></a>
            </div>
          </td>
        </tr>
        <tr [nzExpand]="expandSet.has(data.id)">
          <nz-table #innerTable [nzData]="data.compts" nzSize="middle" [nzShowPagination]="false">
             <thead>
    <tr>

      <th style="background-color: orange;color: white">Solde</th>
      <th style="background-color:orange;color: white">Devise</th>
      <th style="background-color: orange;color: white">Type</th>
      <th style="background-color: orange;color: white">
        <a><i class="material-icons" style="color: white"  (click)="createCompteModal(CompteContent,CompteFooter,data)">person_add_alt</i></a>
      </th>
    </tr>
    </thead>
      <tbody>
      <tr *ngFor="let cmp of innerTable.data" >
        <td>{{ cmp.solde }}</td>
        <td>{{ cmp.devise }}</td>
        <td>{{ cmp.typeCompte }}</td>
      </tr>
      </tbody>
          </nz-table>
        </tr>
       </ng-container>
      </tbody>
    </nz-table>
  </ng-container>

</ng-container>
<ng-template #tplContent let-params let-ref="modalRef">
  <form  #f ="ngForm"  [formGroup]="ClientForm" class="login-form" (ngSubmit)="updateClient()" >

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your fristname!">
        <input type="text" nz-input formControlName="firstName" placeholder="firstname" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your lastName!">
        <input type="text" nz-input formControlName="lastName" placeholder="lastName" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your tele!">
        <input type="number" nz-input formControlName="phone" placeholder="phone" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your email!">
        <input type="email" nz-input formControlName="email" placeholder="email" />
      </nz-form-control>
    </nz-form-item>


    <nz-form-item>
      <nz-form-control [nzSpan]="24" nzErrorTip="Please enter your numero de address!">
        <input type="text" nz-input formControlName="address" placeholder="address" />
      </nz-form-control>
    </nz-form-item>
    <button type="submit" style="width: 100%;" class="btn btn-primary"  (click)="ref.destroy()">Modifier</button>
    <button (click)="ref.destroy()" type="submit" style="width: 100%;" class="btn btn-danger" >Close</button>

  </form>
</ng-template>
<ng-template #tplFooter let-ref="modalRef">

</ng-template>


<ng-template #CompteContent let-params let-ref="modalRef">
  <form  #f ="ngForm"  [formGroup]="CompteForm" class="login-form"  >

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your Devise!">
        <input type="text" nz-input formControlName="devise" placeholder="devise" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control   [nzSpan]="24" nzErrorTip="Please enter your solde!">
        <input type="text" nz-input formControlName="solde" placeholder="solde" />
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control [nzSpan]="24" nzErrorTip="Slectionner le type du Compte!">
        <nz-select
          id="typeCompte"
          formControlName="typeCompte"
          nzPlaceHolder="Slectionner le type du Compte!"
          nzAllowClear
        >
          <nz-option nzValue="premium" nzLabel="Premium"></nz-option>
          <nz-option nzValue="standard" nzLabel="Standard"></nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>

    <button type="submit" style="width: 100%;" class="btn btn-primary"  (click)="ref.destroy()">Ajouter</button>
    <button (click)="ref.destroy()" type="submit" style="width: 100%;" class="btn btn-danger" >Close</button>

  </form>
</ng-template>
<ng-template #CompteFooter let-ref="modalRef">

</ng-template>
